{{/*
  Usage: {{< asciicinema file="zefz">}}
  You also need to put these in the frontmatter of the page:
  ---
  params:
    asciinema: true
  ---
*/}}
{{$file := .Get "file" }}

{{$fileUrl := relURL (printf "asciinema/%s.cast" $file) }}
{{$fileGifUrl := relURL (printf "asciinema/%s.gif" $file) }}

<div id="ap-{{$file}}" class="asciinema-player asciinema-player-class"><img src="{{$fileGifUrl}}" alt="Demo {{$file}}" loading="lazy"></div>
<script>
  asciinemaPlayerElement["{{$file}}"] = document.getElementById('ap-{{$file}}');

  window.addEventListener("load", (event) => {

    document.fonts.load("1em JetBrainsMono NFM").then(() => {
      // once the font is loaded auto play
      asciinemaPlayerElement["{{$file}}"].innerHTML = "";
      AsciinemaPlayer.create('{{$fileUrl}}', asciinemaPlayerElement["{{$file}}"], {
        idleTimeLimit: 2,
        autoPlay: true,
        loop: true,
        theme: "dracula",
        terminalFontFamily: "'JetBrainsMono NFM', monospace"
      });
    });
  });
</script>